title @s subtitle ""
execute if entity @s[tag=looking_at_map] run function luigis_mansion:items/gameboy_horror/map/close
execute unless score #loaded_exterior Selected matches 0 in minecraft:overworld run function luigis_mansion:entities/e_gadd/load_exterior/mansion
scoreboard players reset @s Element
execute if entity @a[nbt={Inventory:[{tag:{luigis_mansion:{id:"luigis_mansion:poltergust_3000"}}}]}] run function luigis_mansion:items/poltergust_3000/no_element
execute in minecraft:overworld run teleport @s 760 89.9375 8.0 90 0
execute in minecraft:overworld positioned 789 90 14 unless entity @e[distance=..0.7,tag=e_gadd,limit=1] run function luigis_mansion:spawn_entities/e_gadd
scoreboard objectives setdisplay sidebar Element
scoreboard players set #mansion_type Selected 1
execute unless score #mansion_data_index Selected matches 0 run scoreboard players set #can_clear_hidden Selected 1
execute unless score #mansion_data_index Selected matches 0 if data storage luigis_mansion:data current_state.current_data.data_index run function luigis_mansion:entities/e_gadd/save_mansion_data
execute unless score #mansion_data_index Selected matches 0 run data modify storage luigis_mansion:data current_state.current_data set value {data_index:0,boo_counter:0,dead_players:[],technical_data:{},used_keys:{},obtained_keys:{},obtained_items:{},money_spawned:{},rooms:{foyer:{seen:1b,cleared:0b},hallway_1:{seen:1b,cleared:0b},parlor:{seen:1b,cleared:0b},anteroom:{seen:0b,cleared:0b},wardrobe_room:{seen:0b,cleared:0b},balcony_1:{seen:0b,cleared:0b},hallway_2:{seen:0b,cleared:0b},study:{seen:0b,cleared:0b},master_bedroom:{seen:0b,cleared:0b},nursery:{seen:0b,cleared:0b},hallway_3:{seen:0b,cleared:0b},hallway_4:{seen:0b,cleared:0b},hallway_5:{seen:0b,cleared:0b},hallway_6:{seen:0b,cleared:0b},hallway_7:{seen:0b,cleared:0b},bathroom_1:{seen:0b,cleared:0b},ball_room:{seen:0b,cleared:0b},storage_room:{seen:0b,cleared:0b},washroom_1:{seen:0b,cleared:0b},fortune_tellers_room:{seen:0b,cleared:0b},mirror_room:{seen:0b,cleared:0b},laundry_room:{seen:0b,cleared:0b},butlers_room:{seen:0b,cleared:0b},hidden_room:{seen:0b,cleared:0b},conservatory:{seen:0b,cleared:0b},dining_room:{seen:0b,cleared:0b},kitchen:{seen:0b,cleared:0b},boneyard:{seen:0b,cleared:0b},graveyard:{seen:0b,cleared:0b},courtyard:{seen:0b,cleared:0b},bottom_of_the_well:{seen:0b,cleared:0b},rec_room:{seen:0b,cleared:0b},hallway_8:{seen:0b,cleared:0b},tea_room:{seen:0b,cleared:0b},hallway_9:{seen:0b,cleared:0b},hallway_10:{seen:0b,cleared:0b},hallway_11:{seen:0b,cleared:0b},hallway_12:{seen:0b,cleared:0b},hallway_13:{seen:0b,cleared:0b},hallway_14:{seen:0b,cleared:0b},hallway_15:{seen:0b,cleared:0b},washroom_2:{seen:0b,cleared:0b},bathroom_2:{seen:0b,cleared:0b},nanas_room:{seen:0b,cleared:0b},astral_hall:{seen:0b,cleared:0b},observatory:{seen:0b,cleared:0b},billiards_room:{seen:0b,cleared:0b},projection_room:{seen:0b,cleared:0b},twins_room:{seen:0b,cleared:0b},safari_room:{seen:0b,cleared:0b},hallway_16:{seen:0b,cleared:0b},hallway_17:{seen:0b,cleared:0b},balcony_2:{seen:0b,cleared:0b},hallway_18:{seen:0b,cleared:0b},hallway_19:{seen:0b,cleared:0b},telephone_room:{seen:0b,cleared:0b},breaker_room:{seen:0b,cleared:0b},cellar:{seen:0b,cleared:0b},hallway_20:{seen:0b,cleared:0b},hallway_21:{seen:0b,cleared:0b},hallway_22:{seen:0b,cleared:0b},clockwork_room:{seen:0b,cleared:0b},roof:{seen:0b,cleared:0b},armory:{seen:0b,cleared:0b},ceramics_studio:{seen:0b,cleared:0b},sealed_room:{seen:0b,cleared:0b},pipe_room:{seen:0b,cleared:0b},cold_storage:{seen:0b,cleared:0b},sitting_room:{seen:0b,cleared:0b},guest_room:{seen:0b,cleared:0b},artists_studio:{seen:0b,cleared:0b},secret_altar:{seen:0b,cleared:0b}},portrait_ghosts:{neville:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},lydia:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},chauncey:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},floating_whirlindas:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},shivers:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},melody_pianissima:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},mr_luggs:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},spooky:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},bogmire:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},biff_atlas:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},miss_petunia:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},nana:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},slim_bankshot:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},henry_and_orville:{portrificationized:0b,henry_health:10000,henry_max_health:10000,orville_health:10000,orville_max_health:10000,rank:0b,henry_loot:{},orville_loot:{}},madame_clairvoya:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},boolossus:{portrificationized:0b,health:15,max_health:15,rank:0b,loot:{}},uncle_grimmly:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},clockwork_soldiers:{portrificationized:0b,pink_health:10000,pink_max_health:10000,blue_health:10000,blue_max_health:10000,green_health:10000,green_max_health:10000,rank:0b,pink_loot:{},blue_loot:{},green_loot:{}},jarvis:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},sir_weston:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},sue_pea:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},vincent_van_gore:{portrificationized:0b,health:10000,max_health:10000,rank:0b,loot:{}},king_boo:{portrificationized:0b,health:50000,max_health:50000,rank:0b,loot:{}}},boos:[{name:"bamboo",room:3,trap_found:0b,loot:{},speed:10,health:15000},{name:"bootha",room:4,trap_found:0b,loot:{},speed:4,health:6000},{name:"gameboo_advance",room:5,trap_found:0b,loot:{},speed:3,health:4000},{name:"taboo",room:8,trap_found:0b,loot:{},speed:5,health:6000},{name:"boolicious",room:9,trap_found:0b,loot:{},speed:6,health:4000},{name:"turboo",room:10,trap_found:0b,loot:{},speed:10,health:3000},{name:"boo_la_la",room:17,trap_found:0b,loot:{},speed:4,health:8000},{name:"gameboo",room:18,trap_found:0b,loot:{},speed:6,health:6000},{name:"kung_boo",room:21,trap_found:0b,loot:{},speed:6,health:5000},{name:"boogie",room:22,trap_found:0b,loot:{},speed:4,health:5000},{name:"peekaboo",room:23,trap_found:0b,loot:{},speed:6,health:10000},{name:"gumboo",room:24,trap_found:0b,loot:{},speed:6,health:5000},{name:"boomeo",room:25,trap_found:0b,loot:{},speed:6,health:5000},{name:"boodacious",room:26,trap_found:0b,loot:{},speed:10,health:15000},{name:"booligan",room:27,trap_found:0b,loot:{},speed:6,health:10000},{name:"booregard",room:32,trap_found:0b,loot:{},speed:6,health:10000},{name:"mr_boojangles",room:34,trap_found:0b,loot:{},speed:7,health:6000},{name:"limbooger",room:44,trap_found:0b,loot:{},speed:9,health:10000},{name:"boonswoggle",room:45,trap_found:0b,loot:{},speed:10,health:8000},{name:"boohoo",room:47,trap_found:0b,loot:{},speed:6,health:8000},{name:"shamboo",room:48,trap_found:0b,loot:{},speed:12,health:20000},{name:"booris",room:49,trap_found:0b,loot:{},speed:6,health:10000},{name:"booigi",room:20,trap_found:0b,loot:{},speed:6,health:5000},{name:"little_boo_peep",room:50,trap_found:0b,loot:{},speed:8,health:10000},{name:"boo_b_hatch",room:57,trap_found:0b,loot:{},speed:12,health:10000},{name:"booripedes",room:58,trap_found:0b,loot:{},speed:6,health:15000},{name:"boomerang",room:56,trap_found:0b,loot:{},speed:6,health:20000},{name:"booscaster",room:62,trap_found:0b,loot:{},speed:15,health:5000},{name:"underboo",room:64,trap_found:0b,loot:{},speed:9,health:20000},{name:"tamboorine",room:65,trap_found:0b,loot:{},speed:6,health:15000},{name:"booffant",room:67,trap_found:0b,loot:{},speed:3,health:30000},{name:"boolderdash",room:68,trap_found:0b,loot:{},speed:9,health:30000},{name:"boolivia",room:69,trap_found:0b,loot:{},speed:8,health:20000},{name:"boonita",room:70,trap_found:0b,loot:{},speed:6,health:10000},{name:"bootique",room:71,trap_found:0b,loot:{},speed:6,health:20000}],money:{gold_coin:0,bill:0,gold_bar:0,blue_sapphire:0,green_emerald:0,red_ruby:0,blue_diamond:0,red_diamond:0,gold_diamond:0,small_pearl:0,medium_pearl:0,big_pearl:0},ghosts:{gold_ghost:{health:1000,loot:{}},temper_terror:{health:1000,loot:{}},speedy_spirit:{health:1000,loot:{}},purple_puncher:{health:2000,loot:{}},flash:{health:2000,loot:{}},blue_twirler:{health:3000,loot:{}},blue_blaze:{health:3000,loot:{}},garbage_can_ghost:{health:4000,loot:{}},ceiling_surprise:{health:1,loot:{}},purple_bomber:{health:1,loot:{}},bowling_ghost:{health:1,loot:{}},grabbing_ghost:{health:1000,loot:{}},red_grabbing_ghost:{health:2000,loot:{}},mirror_ghost:{health:2000,loot:{}},cinema_ghost:{health:2000,loot:{}},ghost_guy:{health:2000,loot:{}},dancing_ghost_guy:{health:2000,loot:{}},mr_bones:{health:3000,loot:{}},waiter:{health:1000,loot:{}}}}
scoreboard players operation #previous_mansion_index Selected = #mansion_data_index Selected
scoreboard players set #mansion_data_index Selected 0
execute unless score #mansion_data_index Selected = #previous_mansion_index Selected if data storage luigis_mansion:data current_state.mansion_data[-1] run function luigis_mansion:entities/e_gadd/load_mansion_data
scoreboard players set #mirrored Selected 1
scoreboard players set #multiply_hurt Selected 200
scoreboard players set #multiply_damage Selected 100
scoreboard players set #can_warp Selected 1
scoreboard players set #changing_max_health Selected 0
scoreboard players set @s Room 0
stopsound @s music
playsound luigis_mansion:music.leaving_the_lab music @s ~ ~ ~ 1000
scoreboard players set @s MusicType 0
scoreboard players set @s Music 260
scoreboard players set @s Health 100
tag @s remove seen_room_name
tag @s remove seen_room_name_2