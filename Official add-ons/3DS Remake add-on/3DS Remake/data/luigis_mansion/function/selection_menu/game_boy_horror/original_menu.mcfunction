execute unless entity @s[scores={WarpTime=1..}] run function luigis_mansion:entities/player/run_command_as_model {command:"tag @s remove scanning"}
execute unless entity @s[scores={WarpTime=1..}] run tag @s add game_boy_horror_menu
function luigis_mansion:entities/player/run_command_as_model {command:"tag @s add animation_free_rotation"}

execute unless entity @s[scores={WarpTime=1..}] run data modify storage luigis_mansion:data menu_options set value {options:[]}
execute unless entity @s[scores={WarpTime=1..}] run function luigis_mansion:selection_menu/game_boy_horror/map/check
execute unless entity @s[scores={WarpTime=1..}] unless data storage luigis_mansion:data current_state.current_data.portrait_battle run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/map","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.map"},"minecraft:custom_data":{option:{id:"map/open"}}}}
execute unless entity @s[scores={WarpTime=1..}] unless data storage luigis_mansion:data current_state.current_data.portrait_battle if entity @s[tag=no_map] run data modify storage luigis_mansion:data menu_options.options[0].components."minecraft:custom_data".option.id set value "reload"
tag @s remove no_map
execute unless entity @s[scores={WarpTime=1..}] if data storage luigis_mansion:data current_state.current_data.portrait_battle run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"3ds_remake:menu/game_boy_horror/stop_portrait_battle","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"3ds_remake:item.menu.game_boy_horror.stop_portrait_battle"},"minecraft:custom_data":{option:{id:"stop_portrait_battle"}}}}
execute unless entity @s[scores={WarpTime=1..}] if data storage 3ds_remake:data {shown_gameboy_horror_part:1b} run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/scan_furniture","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.scan_furniture"},"minecraft:custom_data":{option:{id:"scan_furniture"}}}}
execute unless entity @s[scores={WarpTime=1..}] unless data storage luigis_mansion:data current_state.current_data.portrait_battle run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/show_inventory","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.show_inventory"},"minecraft:custom_data":{option:{id:"show_inventory"}}}}
execute unless entity @s[scores={WarpTime=1..}] unless data storage luigis_mansion:data current_state.current_data.portrait_battle run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/show_caught_portrait_ghosts","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.show_caught_portrait_ghosts"},"minecraft:custom_data":{option:{id:"show_caught_portrait_ghosts"}}}}
execute unless entity @s[scores={WarpTime=1..}] run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/show_settings","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.show_settings"},"minecraft:custom_data":{option:{id:"show_settings"}}}}
execute unless entity @s[scores={WarpTime=1..}] run data modify storage luigis_mansion:data menu_options.options append value {id:"minecraft:diamond_pickaxe",count:1,components:{"minecraft:item_model":"luigis_mansion:menu/game_boy_horror/jukebox","minecraft:unbreakable":{},"minecraft:tooltip_display":{hidden_components:["minecraft:unbreakable"]},"minecraft:attribute_modifiers":[],"minecraft:item_name":{type:"translatable",translate:"luigis_mansion:item.menu.game_boy_horror.jukebox"},"minecraft:custom_data":{option:{id:"jukebox"}}}}

execute unless entity @s[scores={WarpTime=1..}] run function luigis_mansion:entities/player/run_command_as_model {command:"execute unless entity @s[nbt={data:{animation:{namespace:\"luigis_mansion\",id:\"game_boy_horror\"}}}] run function luigis_mansion:entities/luigi/animation/set/game_boy_horror"}

execute unless entity @s[scores={WarpTime=1..}] run function luigis_mansion:entities/player/selection_menu/load
execute if entity @s[scores={WarpTime=1..}] run function luigis_mansion:selection_menu/game_boy_horror/scan_furniture